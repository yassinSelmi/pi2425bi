<div class="respiratory-app">
  <!-- Section principale de prÃ©diction -->
  <div class="prediction-container">
    <div class="prediction-header">
      <h2><span class="emoji">ğŸ©º</span> PrÃ©diction Maladies Respiratoires</h2>
      <p class="subtitle">Analyse des sons respiratoires par intelligence artificielle</p>
    </div>

    <!-- Zone de dÃ©pÃ´t amÃ©liorÃ©e -->
    <div class="drop-zone" 
         (click)="fileInput.click()"
         (drop)="onDrop($event)"
         (dragover)="onDragOver($event)"
         [class.active]="isDragOver">
      <div class="drop-content">
        <i class="upload-icon">ğŸ¤</i>
        <p>Glissez-dÃ©posez votre enregistrement ou <span>parcourir</span></p>
        <p class="file-types">Formats supportÃ©s: .wav, .mp3, .aac</p>
      </div>
      <input #fileInput type="file" (change)="onFileSelected($event)" accept="audio/*" hidden>
    </div>

    <!-- Bouton d'analyse avec Ã©tat de chargement -->
    <button class="analyze-btn" (click)="submitAudio()" [disabled]="!selectedFile || isLoading">
      <span *ngIf="!isLoading">Analyser l'audio</span>
      <span *ngIf="isLoading" class="spinner">
        <span class="spinner-dot">.</span>
        <span class="spinner-dot">.</span>
        <span class="spinner-dot">.</span>
      </span>
    </button>

    <!-- PrÃ©visualisation audio -->
    <div *ngIf="audioPreview" class="preview-container">
      <div class="preview-header">
        <h3>Enregistrement sÃ©lectionnÃ© :</h3>
        <button class="clear-btn" (click)="clearSelection()">Ã—</button>
      </div>
      <div class="audio-wrapper">
        <audio controls [src]="audioPreview" class="audio-player"></audio>
        <div *ngIf="isLoading" class="loading-overlay">
          <div class="loading-spinner"></div>
          <p>Analyse en cours...</p>
        </div>
      </div>
    </div>

    <!-- RÃ©sultats avec visualisation amÃ©liorÃ©e -->
    <div *ngIf="prediction" class="result-container" [class.high-risk]="isHighRisk">
      <div class="result-header">
        <h3>RÃ©sultat de l'analyse :</h3>
        <span class="risk-indicator">{{ isHighRisk ? 'âš ï¸ Attention' : 'âœ… Normal' }}</span>
      </div>
      <div class="result-content">
        <div class="confidence-meter">
          <div class="meter-bar" [style.width.%]="confidence * 100"></div>
          <span class="confidence-value">{{ (confidence * 100).toFixed(1) }}% de confiance</span>
        </div>
        
        <div class="diagnosis-box">
          <div class="diagnosis-icon">
            <span *ngIf="isHighRisk">ğŸ©º</span>
            <span *ngIf="!isHighRisk">ğŸŒ¬ï¸</span>
          </div>
          <div class="diagnosis-text">
            <h4>Diagnostic probable :</h4>
            <p class="prediction-text">{{ prediction }}</p>
          </div>
        </div>
        
        <div *ngIf="isHighRisk" class="emergency-actions">
          <button class="emergency-btn">
            <i class="emergency-icon">ğŸš¨</i> Consulter un pneumologue
          </button>
          <button class="info-btn" (click)="showInfoModal = true">
            <i class="info-icon">â„¹ï¸</i> SymptÃ´mes Ã  surveiller
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Section article amÃ©liorÃ©e -->
  <div class="article-container">
    <article class="resp-article">
      <header class="article-header">
        <h2><span class="emoji">ğŸŒ¬ï¸</span> Comprendre les Maladies Respiratoires et l'IA</h2>
        <p class="article-subtitle">DÃ©tection prÃ©coce par analyse audio</p>
      </header>

      <div class="article-content">
        <p>
          Les maladies respiratoires comme l'asthme, la BPCO ou la fibrose pulmonaire affectent des millions de personnes. 
          Notre IA analyse les caractÃ©ristiques audio des sons respiratoires avec une prÃ©cision de 94% pour dÃ©tecter ces pathologies Ã  un stade prÃ©coce.
        </p>

        <div class="sound-visualization">
          <div class="sound-wave">
            <div class="wave" *ngFor="let wave of [1,2,3,4,5,6,7,8,9,10]" 
                 [style.height.px]="getRandomWaveHeight()"></div>
          </div>
          <div class="sound-types">
            <div class="sound-type" *ngFor="let type of soundTypes">
              <span class="sound-icon">{{ type.icon }}</span>
              <span class="sound-label">{{ type.label }}</span>
            </div>
          </div>
        </div>

        <div class="ai-facts">
          <h3><span class="emoji">ğŸ¤–</span> Comment l'IA analyse-t-elle votre respiration?</h3>
          <p>Notre modÃ¨le examine plus de 120 caractÃ©ristiques audio dont:</p>
          <div class="features-grid">
            <div class="feature-item">
              <span class="feature-icon">ğŸµ</span>
              <span>FrÃ©quences caractÃ©ristiques</span>
            </div>
            <div class="feature-item">
              <span class="feature-icon">ğŸ“Š</span>
              <span>Patterns de sifflements</span>
            </div>
            <div class="feature-item">
              <span class="feature-icon">â±ï¸</span>
              <span>DurÃ©e des phases respiratoires</span>
            </div>
            <div class="feature-item">
              <span class="feature-icon">ğŸ”Š</span>
              <span>IntensitÃ© des sons anormaux</span>
            </div>
          </div>
        </div>

        <div class="recommendations">
          <h3><span class="emoji">âœ…</span> Conseils pour une meilleure santÃ© respiratoire :</h3>
          <div class="recommendations-grid">
            <div class="recommendation-card">
              <div class="card-icon" style="background-color: #ff6b6b;">ğŸš­</div>
              <h4>Ã‰viter le tabac</h4>
              <p>PremiÃ¨re cause de maladies respiratoires chroniques</p>
            </div>
            <div class="recommendation-card">
              <div class="card-icon" style="background-color: #48dbfb;">ğŸ˜·</div>
              <h4>Protection</h4>
              <p>Masque en milieu polluÃ© ou lors d'Ã©pidÃ©mies</p>
            </div>
            <div class="recommendation-card">
              <div class="card-icon" style="background-color: #1dd1a1;">ğŸŒ¿</div>
              <h4>Air pur</h4>
              <p>Plantes dÃ©polluantes et aÃ©ration quotidienne</p>
            </div>
            <div class="recommendation-card">
              <div class="card-icon" style="background-color: #f368e0;">ğŸƒâ€â™€ï¸</div>
              <h4>Exercice</h4>
              <p>30 minutes d'activitÃ© modÃ©rÃ©e 3 fois/semaine</p>
            </div>
            <div class="recommendation-card">
              <div class="card-icon" style="background-color: #ff9f43;">ğŸ§˜</div>
              <h4>Respiration</h4>
              <p>Exercices de respiration profonde quotidienne</p>
            </div>
          </div>
        </div>

        <div class="emergency-info">
          <h3><span class="emoji">âš ï¸</span> SymptÃ´mes d'alerte :</h3>
          <div class="symptoms-grid">
            <div class="symptom-item">
              <div class="symptom-icon">ğŸ˜¤</div>
              <p>Essoufflement anormal</p>
            </div>
            <div class="symptom-item">
              <div class="symptom-icon">ğŸ¤§</div>
              <p>Toux persistante (>3 semaines)</p>
            </div>
            <div class="symptom-item">
              <div class="symptom-icon">ğŸ’¨</div>
              <p>Sifflements respiratoires</p>
            </div>
            <div class="symptom-item">
              <div class="symptom-icon">ğŸ©¸</div>
              <p>Crachats sanguinolents</p>
            </div>
          </div>
        </div>
      </div>
    </article>
  </div>

  <!-- Modal d'information -->
  <div *ngIf="showInfoModal" class="info-modal">
    <div class="modal-content">
      <button class="close-modal" (click)="showInfoModal = false">Ã—</button>
      <h3>SymptÃ´mes Ã  surveiller</h3>
      <ul class="symptoms-list">
        <li *ngFor="let symptom of criticalSymptoms">{{ symptom }}</li>
      </ul>
      <button class="modal-btn" (click)="showInfoModal = false">J'ai compris</button>
    </div>
  </div>
</div>